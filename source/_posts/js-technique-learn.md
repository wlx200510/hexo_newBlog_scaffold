---
title: Javascriptä¸€äº›ä¼˜é›…å®ç°
date: 2017-10-22 21:34:55
categories:
- å­¦ä¹ 
tags:
- javascript
- æ€»ç»“
---
ä½œä¸ºä¸€ä¸ªjser, å½“å¯¹ä¸€é—¨è¯­è¨€çš„ä½¿ç”¨åˆ°è¾¾ä¸€å®šé‡æ—¶ï¼Œä¸å…ä¼šç–²å€¦ï¼Œä»…ä»¥æ­¤æ–‡æ¥æƒŠé†’ï¼Œå…¶å®å®ƒè¿˜æœ‰å¾ˆå¤šåœ°æ–¹ç­‰å¾…æ¢ç´¢~
<!-- more -->
<!-- excerpt -->
## ä¼˜é›…å®ç°`sleep`çš„æ•ˆæœ
åœ¨è¯¸å¦‚`python/Java`ä¸­éƒ½æœ‰`sleep`å‡½æ•°ï¼Œä½†`js`æ²¡æœ‰ï¼Œé‚£åº”è¯¥å¦‚ä½•ç”¨æœ€ä¼˜é›…çš„æ–¹æ³•å®ç°ï¼Ÿ
### ç²—æš´ç‰ˆæœ¬
```js
function sleep(time) {
    for (var start = +new Date; +new Date - start < time;) {}
}
```
è¿™æ ·å°±ä¼šæŠŠæ‰€æœ‰çš„æ‰§è¡Œä»»åŠ¡`block`æ‰, å®¢æˆ·ç«¯è¿˜å¥½ï¼ŒæœåŠ¡å™¨å°±ç‚¸æ¯›äº†ã€‚

### `Promise`ç‰ˆæœ¬
```js
function sleep(time) {
    return new Promise((resolve) => setTimeout(resolve, time))
}
const t1 = +new Date()
sleep(3000).then(()=>{
    const t2 = +new Date()
    console.log(t2 - t1)
})
```
è¿™ç§æ–¹å¼ä¸ä¼šé˜»å¡ï¼Œæ— è´Ÿè½½é—®é¢˜ï¼Œä½¿ç”¨æ—¶ä»£ç é‡ä¸å¤šï¼Œä½†`Promise`å†…éƒ¨çš„ä»£ç å‡ºé”™åéœ€è¦å±‚å±‚åˆ¤æ–­å`catch`ï¼Œè¿˜æ˜¯æœ‰äº›éº»çƒ¦ã€‚

### `Async/Await`ç‰ˆæœ¬çš„å»¶è¿Ÿå‡½æ•°
```js
function sleep(delay) {
  return new Promise(reslove => {
    setTimeout(reslove, delay)
  })
}

async function test() {
  const t1 = +new Date()
  await sleep(3000)
  const t2 = +new Date()
  console.log(t2 - t1)
}()
```
å„ä¸ªå‡½æ•°éƒ½æ˜¯éåµŒå¥—ç»“æ„ï¼Œç°åœ¨å¼€å§‹è¦æ‹¥æŠ±è¿™ç§å†™æ³•ï¼Œæ•´ä½“å†™æ³•å¯å‚ç…§ï¼š[å››ä¸ªæ”¹è¿›ç‚¹](https://juejin.im/post/59f9ce7a51882554f666220f)

### ç”¨`C++`å®ç°çš„ç»å¯¹ä¼˜é›…
> è¿™é‡Œæœ‰ C++ å®ç°çš„æ¨¡å—ï¼šhttps://github.com/ErikDubbelboer/node-sleep

```js
const sleep = require("sleep")

const t1 = +new Date()
sleep.msleep(3000)
const t2 = +new Date()
console.log(t2 - t1)
```
*ç°åœ¨å¼€å§‹å¼‚æ­¥è¯·æ±‚éƒ½è¦è¯•ç€åœ¨Promiseçš„åŸºç¡€ä¸Šæ‹¥æŠ±Async/Await*

## è·å–æ—¶é—´æˆ³çš„æ–¹æ³•
1. ç¬¬ä¸€å±‚çº§åˆ«ï¼š`var timestamp = new Date().getTime()`
2. ç¬¬äºŒå±‚çº§åˆ«ï¼š`var timestamp = (new Date()).valueOf()` ä½¿ç”¨`valueOf`æ–¹æ³•è¿”å›å¯¹è±¡çš„åŸå§‹å€¼
3. ç¬¬ä¸‰å±‚çº§åˆ«ï¼š`var timestamp = +new Date()` ä½¿ç”¨äº†éšå¼è½¬æ¢ å¯å‚è€ƒ[æ¥æºåšæ–‡](https://github.com/jawil/blog/issues/30) è®²çš„å¾ˆè¯¦ç»†

è¿™ä¸ªæ–¹é¢åŸæ–‡ä¸­å¯¹éšå¼è½¬æ¢è®²è§£çš„æ¯”è¾ƒé€å½»ï¼Œä½œä¸ºjsçš„åŸºç¡€åº”è¯¥é€‚å½“å›é¡¾å­¦ä¹ ã€‚åŸå§‹å€¼æŒ‡çš„æ˜¯ 'Null','Undefined','String','Boolean','Number','Symbol' 6ç§åŸºæœ¬æ•°æ®ç±»å‹ä¹‹ä¸€ï¼Œä¸èƒ½å¿˜å´ã€‚

## æ•°ç»„å»é‡çš„ç®—æ³•è¿›é˜¶

> æš‚ä¸è€ƒè™‘å¯¹è±¡å­—é¢é‡ï¼Œå‡½æ•°ç­‰å¼•ç”¨ç±»å‹çš„å»é‡ï¼Œä¹Ÿä¸è€ƒè™‘ NaN, undefined, nullç­‰ç‰¹æ®Šç±»å‹æƒ…å†µ

### æ™®é€šç‰ˆ
åªè¯´ä¸‹æ€è·¯ï¼Œè¿™ç§å¤æ‚åº¦ä¸ºå¹³æ–¹çš„ä¸å†ä¸Šä»£ç ï¼Œæ•´ä½“å°±æ˜¯å¯¹è¿™ä¸ªæ•°ç»„æ¯ä¸ªå…ƒç´ å–å‡ºæ¥æ”¾åˆ°å¦ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œåœ¨æ”¾å…¥ä¹‹å‰æ£€éªŒè¿™ä¸ªæ–°æ•°ç»„ä¸­æ˜¯å¦å·²æœ‰è¿™ä¸ªå€¼ï¼Œé˜²æ­¢é‡å¤æ³¨å…¥

### è¿›é˜¶ç‰ˆ
```js
var a =  [1, 1, '1', '2', 1]
function unique(arr) {
    return arr.filter(function(ele,index,array){
        return array.indexOf(ele) === index
    })
}
console.log(unique(a)) // [1, 2, "1"]
```
åˆ©ç”¨å‡½æ•°å¼ç¼–ç¨‹ä¸€å¯¹ä¸€å»æ‰é‡å¤çš„æ•°ï¼Œå†™æ³•ç›¸å½“ä¼˜é›…ï¼Œä½†å¤æ‚åº¦ä¸åŸºç¡€ç‰ˆç›¸å½“

### è¶…è¿›é˜¶ç‰ˆ
```js
function unique(arr) {
    var obj = {}
    return arr.filter(function(item, index, array){
        return obj.hasOwnProperty(typeof item + item) ? 
        false : 
        (obj[typeof item + item] = true)
    })
}
```
ä¹‹å‰æœ€å–œæ¬¢çš„ä¸€ç§å»é‡æ–¹æ³•ï¼Œé€šè¿‡å¼•å…¥å­—å…¸æŸ¥æ‰¾ï¼Œå°†å¤æ‚åº¦é™ä½ä¸º`O(n)`ï¼Œè¿™ä¸ªç¤ºä¾‹æ›´åŠ æç«¯ï¼ŒæŠŠä»£ç ç¼©å‡åˆ°æè‡´ ä¸è¿‡æ˜“è¯»æ€§å—å½±å“

### ç©¶æè¿›åŒ–ç‰ˆ
```js
const unique = a => [...new Set(a)]
```
`ES6`çš„`Set`æ•°æ®ç»“æ„ä¸è§£æ„å†™æ³•çš„å®Œç¾ç»“åˆï¼Œæœ€ä¼˜é›…å†™æ³•å’Œå¯è¯»æ€§ã€‚

## æ•°ç»„çš„è½¬åŒ–ä¸æ±‚å’Œ
åœ¨å‰ç«¯æ•°ç»„æ˜¯ä¸€ä¸ªæœ€å¸¸ç”¨çš„æ•°æ®ç»“æ„ï¼Œè¿™æ˜¯ä¸¤ä¸ªæ•°ç»„å¸¸ç”¨çš„æ“ä½œï¼Œçœ‹ä¸€ä¸‹å¦‚ä½•ä¼˜é›…å®ç°
### æ•°ç»„è½¬åŒ–
éœ€æ±‚æ˜¯æŠŠ`argruments`å¯¹è±¡(ç±»æ•°ç»„)è½¬æ¢æˆæ•°ç»„:
- å…¼å®¹æ€§è‰¯å¥½çš„ç‰ˆæœ¬ï¼š`var arr = Array.prototype.slice.call(arguments);` ä¸å†èµ˜è¿°
- ES6çš„æ–°å†™æ³•ï¼š`var arr = Array.from(arguments);`(æœ‰lengthå±æ€§å°±å¯ä»¥) `var args = [...arguments];`(è§£æ„å†™æ³•)

ç¬¬ä¸€ç§æ–¹æ³•çš„åŸç†æ¥æºåšå®¢è®²å¾—æ¯”è¾ƒç»†ï¼Œä¸»è¦æ˜¯æ¢ç©¶`ArraySlice`çš„æºç å®ç°ï¼Œæ‘˜æŠ„å¦‚ä¸‹ï¼š

> `slice.call`çš„ä½œç”¨åŸç†å°±æ˜¯ï¼Œåˆ©ç”¨`call`ï¼Œå°†`slice`çš„æ–¹æ³•ä½œç”¨äº `arrayLike`ï¼Œ`slice`çš„ä¸¤ä¸ªå‚æ•°ä¸ºç©ºï¼Œ`slice`å†…éƒ¨è§£æä½¿å¾— `arguments.lengt`ç­‰äº0çš„æ—¶å€™ ç›¸å½“äºå¤„ç† `slice(0)` ï¼š å³é€‰æ‹©æ•´ä¸ªæ•°ç»„ï¼Œ`slice`æ–¹æ³•å†…éƒ¨æ²¡æœ‰å¼ºåˆ¶åˆ¤æ–­å¿…é¡»æ˜¯`Array`ç±»å‹ï¼Œ`slice`è¿”å›çš„æ˜¯æ–°å»ºçš„æ•°ç»„ï¼ˆä½¿ç”¨å¾ªç¯å–å€¼ï¼‰â€ï¼Œæ‰€ä»¥è¿™æ ·å°±å®ç°äº†ç±»æ•°ç»„åˆ°æ•°ç»„çš„è½¬åŒ–ï¼Œ`call`è¿™ä¸ªç¥å¥‡çš„æ–¹æ³•ã€`slice`çš„å¤„ç†ç¼ºä¸€ä¸å¯ã€‚

### æ•°ç»„æ±‚å’Œ
ç›´æ¥ä¸Šæœ€ä¼˜é›…çš„è¿­ä»£
```js
let arr = [1, 2, 3, 4, 5]
function sum(arr) {
return arr.reduce((a, b) => a + b)
}
sum(arr) //15
```

## ä½è¿ç®—é»‘ç§‘æŠ€æ€»ç»“
è¿™ä¸ªå°èŠ‚æ¥è§¦ä¸€ä¸‹ä¼ è¯´ä¸­çš„`ACM`å¸¸ç”¨æŠ€å·§~
### äº¤æ¢ä¸¤ä¸ªæ•°å­—
1. å¼•å…¥ä¸­é—´å˜é‡çš„æ–¹æ³•(ç•¥å»ä¸å†™)
2. ä½¿ç”¨çº¯æ•°å­—è¿ç®—çš„æ–¹æ³•(ç‰¹åˆ«å¤§çš„æ•°å­—ä¸è¡Œ)
```js
let a = 3,b = 4
a += b
b = a - b
a -= b
```
3. è§£æ„èµ‹å€¼ `[a, b] = [b, a]`
4. ç”¨å¼‚æˆ–å®ç°
```js
let a = 3,b = 4
  a ^= b
  b ^= a
  a ^= b
console.log(a, b)
```
> å¯¹äºå¼€å§‹çš„ä¸¤ä¸ªèµ‹å€¼è¯­å¥ï¼Œ`a=a^bï¼Œb=b^a`ï¼Œç›¸å½“äº`b=b^(a^b)=a^b^b`ï¼Œè€Œ`b^b`æ˜¾ç„¶ç­‰äº0ã€‚å› æ­¤`b=a^0`ï¼Œæ˜¾ç„¶ç»“æœä¸º`a`ã€‚
> åŒç†å¯ä»¥åˆ†æç¬¬ä¸‰ä¸ªèµ‹å€¼è¯­å¥ï¼Œ`a=a^b=(a^b)^a=b`

ä¼˜ç‚¹ï¼šä¸å­˜åœ¨å¼•å…¥ä¸­é—´å˜é‡ï¼Œä¸å­˜åœ¨æ•´æ•°æº¢å‡º
ç¼ºç‚¹ï¼šå‰ç«¯å¯¹ä½æ“ä½œè¿™ä¸€å—å¯èƒ½äº†è§£ä¸æ·±ï¼Œä¸å®¹æ˜“ç†è§£

### æ•°å­—å–æ•´
è¿™æ˜¯ä¸ªæ¯”è¾ƒå¸¸è§çš„å‰ç«¯éœ€æ±‚ï¼Œæ™®é€šçš„å¤„ç†åŠæ³•æœ‰`parseInt`å’Œ`Math.trunc`ç­‰
å„ç§ä½è¿ç®—é»‘ç§‘æŠ€ç³»åˆ—(å¤§æ•°fail)ï¼š
1. `~~number`å–æ•´
```js
console.log(~~47.11)  // -> 47
console.log(~~1.9999) // -> 1
console.log(~~3)      // -> 3
console.log(~~[])     // -> 0
console.log(~~NaN)    // -> 0
console.log(~~null)   // -> 0
console.log(~~2147493647.123) // -> -2147473649 ğŸ™
```
2. `number | 0`æŒ‰ä½æˆ–å–æ•´
```js
console.log(20.15|0);          // -> 20
console.log((-20.15)|0);       // -> -20
console.log(3000000000.15|0);  // -> -1294967296 ğŸ™
```
3. `number ^ 0`æŒ‰ä½å¼‚æˆ–å–æ•´
```js
console.log(20.15^0);          // -> 20
console.log((-20.15)^0);       // -> -20
console.log(3000000000.15^0);  // -> -1294967296 ğŸ™
```
4. `number << 0`å·¦ç§»å–æ•´
```js
console.log(20.15 < < 0);     // -> 20
console.log((-20.15) < < 0);  //-20
console.log(3000000000.15 << 0);  // -> -1294967296 ğŸ™
```

## å‹è½´ä¹‹æ•°å­—æ ¼å¼åŒ–
> éœ€æ±‚æ˜¯æŠŠ `1234567890` è½¬æ¢ä¸º `1,234,567,890` (åŠ ä¸Šåƒä½åˆ†éš”ç¬¦)

### æ™®é€šç‰ˆ
```js
function formatNumber(str) {
  let arr = [], count = str.length;

  while (count >= 3) {
    arr.unshift(str.slice(count - 3, count))
    count -= 3
  }

  // å¦‚æœæ˜¯ä¸æ˜¯3çš„å€æ•°å°±å¦å¤–è¿½åŠ åˆ°ä¸Šå»
  str.length % 3 && arr.unshift(str.slice(0, str.length % 3))
  return arr.toString()
}
```
è¿™ä¸ªç‰ˆæœ¬å°±æ˜¯æŒ‰ç…§æµçº¿æ€è·¯ä¸‹æ¥ï¼Œå…¶å®ä¹Ÿä¸æ˜¯å¾ˆç®€å•ï¼Œæ€è·¯æ¯”è¾ƒæ™®é€šï¼Œä¸è¿‡ä¹Ÿéœ€è¦æ³¨é‡Š

### è¿›é˜¶ç‰ˆ
```js
function formatNumber(str) {
  // ["0", "9", "8", "7", "6", "5", "4", "3", "2", "1"]
  return str.split("").reverse().reduce((prev, next, index) => {
    return ((index % 3) ? next : (next + ',')) + prev
  })
}
```
æ„Ÿè§‰çœŸå¿ƒæ˜¯å‡½æ•°å¼ç¼–ç¨‹ç©åˆ°éª¨å­é‡Œå»äº†ï¼ŒçœŸå¿ƒæ²¡æ³¨é‡Šä¸å¥½çœ‹æ‡‚ï¼Œç¼–ç¨‹ç ç‘ä¸­æœ‰ç±»ä¼¼çš„æ€è·¯æåˆ°ï¼Œçœ‹å®Œä¹‹åæç„¶å¤§æ‚Ÿçš„æ„Ÿè§‰ã€‚

### è¿›é˜¶æ­£åˆ™ç‰ˆ
```js
function formatNumber(str) {
  return str.replace(/\B(?=(\d{3})+(?!\d))/g, ',')
}
```
å»ºè®®å¥½å¥½å­¦ä¹ è¿™ä¸ªæ€è·¯ï¼Œæ­£åˆ™çœŸå¿ƒæ˜¯ç‘å£«å†›åˆ€ï¼Œç±»ä¼¼é—®é¢˜éƒ½ä¼šæœ‰è¿™ä¸ªæ–¹é¢çš„åŠæ³•ï¼Œå°±æ˜¯æ‰¾åˆ°å¿«æ…¢çš„é—®é¢˜ã€‚
### ç»ˆæè¿›åŒ–ç‰ˆ
```js
(123456789).toLocaleString('en-US')
```
æ²¡çœ‹åˆ°é‚£ç¯‡åšå®¢æ˜¯çœŸä¸çŸ¥é“è¿˜æœ‰è¿™ä¸ª`API`â€¦â€¦
```js
(123456789).toLocaleString('zh-hans-CN-u-nu-hanidec', {useGrouping: false})
(123456789).toLocaleString('zh-hans-CN-u-nu-hanidec', {useGrouping: true})
```
PS: æ„Ÿè§‰æ˜¯æŸç‰›æ€»ç»“çš„[å‰ç«¯å·¥å…·ç®±](https://github.com/CodingMeUp/some_notes/tree/master/%E5%89%8D%E7%AB%AF) å¯ä»¥åˆ†äº«ä¸€æ³¢